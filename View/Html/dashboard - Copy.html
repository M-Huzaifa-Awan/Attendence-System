<!DOCTYPE html>
<html>

<head>
    <title>Dashboard</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

    <style>
        .btn-sm {
            padding: .25rem .5rem;
            font-size: .875rem;
        }

        .date-container {
            margin-right: 10px;
        }
    </style>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

</head>

<body>

    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <a class="navbar-brand" href="#">Attendance System</a>

        <div class="dropdown mr-3">
            <select class="btn btn-secondary" id="sessionDropdown">
                <option value="" selected disabled>Select Session</option>
                <option value="Morning">Morning</option>
                <option value="Evening">Evening</option>
            </select>
        </div>

        <div class="dropdown mr-3">
            <select class="btn btn-secondary" id="semesterDropdown">
                <option value="" selected disabled>Select Semester</option>
                <option value="1">Semester 1</option>
                <option value="2">Semester 2</option>
                <option value="3">Semester 3</option>
                <option value="4">Semester 4</option>
                <option value="5">Semester 5</option>
                <option value="6">Semester 6</option>
                <option value="7">Semester 7</option>
                <option value="8">Semester 8</option>
            </select>
        </div>

        <div class="dropdown mr-3">
            <select class="btn btn-secondary" id="sectionDropdown">
                <option value="" selected disabled>Select Section</option>
                <option value="A">Section A</option>
                <option value="B">Section B</option>
            </select>
        </div>

        <div class="dropdown mr-3">
            <select class="btn btn-secondary" id="subjectDropdown">
                <option value="" selected disabled>Select Subject</option>
                <option value="Subject1">Subject 1</option>
                <option value="Subject2">Subject 2</option>
                <option value="Subject3">Subject 3</option>
                <option value="Subject4">Subject 4</option>
            </select>
        </div>

        <div class="date-container">
            <p class="mb-0">Today's Date: <span id="todayDate"></span></p>
        </div>

        <button class="btn btn-primary" id="submitButton" disabled>Enter</button>

    </nav>

    <!-- Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <script>
        $(document).ready(function () {
            $("#sessionDropdown, #semesterDropdown, #sectionDropdown, #subjectDropdown").on('change', function () {
                checkDropdowns();
            });

            function checkDropdowns() {
                var session = $("#sessionDropdown").val();
                var semester = $("#semesterDropdown").val();
                var section = $("#sectionDropdown").val();
                var subject = $("#subjectDropdown").val();

                if (session !== null && semester !== null && section !== null && subject !== null) {
                    $("#submitButton").prop('disabled', false);
                } else {
                    $("#submitButton").prop('disabled', true);
                }
            }
            // Function to handle Enter button click
            $("#submitButton").on('click', function () {
                sendSelectedOptions();
            });

            // Function to send selected options to the controller
            function sendSelectedOptions() {
                var session = $("#sessionDropdown").val();
                var semester = $("#semesterDropdown").val();
                var section = $("#sectionDropdown").val();
                var subject = $("#subjectDropdown").val();

                // Make a POST request with parameters
                $.ajax({
                    type: "POST",
                    url: "../../Controller/dashboardController.php",
                    data: {
                        session: session,
                        semester: semester,
                        section: section,
                        subject: subject,
                    },
                    success: function (data) {
                        // Handle the response from the server
                        console.log(data);

                        // Redirect to dashboardController.php if needed
                        // window.location.href = "/Controller/dashboardController.php";
                    },
                    error: function () {
                        console.error("Error in sending data");
                    }
                });
            }


            // Display today's date
            var today = new Date();
            var formattedDate = today.getDate() + '/' + (today.getMonth() + 1) + '/' + today.getFullYear();
            $("#todayDate").text(formattedDate);
        });



        /*// Assuming your server returns data in the following format
        var serverResponse = [
            { rollNo: 101, name: 'John Doe', status: 'Present' },
            { rollNo: 102, name: 'Jane Doe', status: 'Absent' },
            // ... more data
        ];

        // Function to generate dynamic HTML based on the server response
        function generateDynamicHTML(data) {
            var tableHTML = '<table class="table table-bordered table-striped"><thead><tr>';
            tableHTML += '<th>Roll No</th><th>Name</th><th>Status</th></tr></thead><tbody>';

            for (var i = 0; i < data.length; i++) {
                tableHTML += '<tr>';
                tableHTML += '<td>' + data[i].rollNo + '</td>';
                tableHTML += '<td>' + data[i].name + '</td>';
                tableHTML += '<td>';
                tableHTML += '<select class="status-dropdown" data-rollno="' + data[i].rollNo + '">';
                tableHTML += '<option value="Present" ' + (data[i].status === 'Present' ? 'selected' : '') + '>Present</option>';
                tableHTML += '<option value="Absent" ' + (data[i].status === 'Absent' ? 'selected' : '') + '>Absent</option>';
                tableHTML += '</select>';
                tableHTML += '</td>';
                tableHTML += '</tr>';
            }

            tableHTML += '</tbody></table>';

            tableHTML += '<div class="mt-3">';
            tableHTML += '<label for="slotDropdown">Select Slot:</label>';
            tableHTML += '<select class="form-control" id="slotDropdown">';
            tableHTML += '<option value="First Slot">First Slot</option>';
            tableHTML += '<option value="Second Slot">Second Slot</option>';
            tableHTML += '</select>';
            tableHTML += '</div>';
            tableHTML += '<button class="btn btn-primary mt-3" id="submitAttendance">Submit</button>';
            tableHTML += '</div>';

            return tableHTML;
        }

        $('#dashboardContent').html(generateDynamicHTML(serverResponse));

        // Event listener for the submit button
        $('#submitAttendance').on('click', function () {
            // Get selected slot
            var selectedSlot = $('#slotDropdown').val();

            // Get data for students with Absent status
            var absentStudents = [];
            $('.status-dropdown option:selected[value="Absent"]').each(function () {
                var rollNo = $(this).parent().data('rollno');
                absentStudents.push({ rollNo: rollNo, slot: selectedSlot });
            });

            // Make a POST request with the absent students data
            $.post("../../Controller/dashboardController.php", { absentStudents: JSON.stringify(absentStudents) }, function (data) {
                // Handle the response from the server
                console.log(data);
            });
        });*/

    </script>

</body>

</html>
